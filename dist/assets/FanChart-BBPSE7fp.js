import{r as A,C as N,j as I}from"./index-ihEVNZHy.js";const D="rgba(255,255,255,0.08)",L="rgba(255,255,255,0.38)",M="rgba(255,255,255,0.07)",W="rgba(255,255,255,0.15)",V="#E5E7EB";function z({artifact:n}){const S=A.useRef(null),b=A.useRef(null),x=A.useMemo(()=>{var m,y,E,R;const g=o=>Array.isArray(o)?o.filter(t=>Array.isArray(t)&&t.length>=2&&Number.isFinite(t[0])&&Number.isFinite(t[1])):[],p=g(n==null?void 0:n.median_path),a=p.map(([o])=>o),u=p.map(([,o])=>o),l=o=>{if(!a.length)return[];const t=g(o);return t.length?a.map((d,i)=>{var P;const f=(P=t[i])==null?void 0:P[1];if(Number.isFinite(f))return f;const F=u[i];return Number.isFinite(F)?F:0}):a.map((d,i)=>Number.isFinite(u[i])?u[i]:0)},h=l((m=n==null?void 0:n.bands)==null?void 0:m.p80_low),s=l((y=n==null?void 0:n.bands)==null?void 0:y.p80_high),r=l((E=n==null?void 0:n.bands)==null?void 0:E.p95_low),e=l((R=n==null?void 0:n.bands)==null?void 0:R.p95_high);return{xs:a,median:u,p80L:h,p80H:s,p95L:r,p95H:e}},[n]);return A.useEffect(()=>{var h;const g=(h=S.current)==null?void 0:h.getContext("2d");if(!g)return;b.current&&(b.current.destroy(),b.current=null);const p={id:"fanBands",beforeDatasetsDraw(s){var T;const{chartArea:r,ctx:e}=s,{top:m,bottom:y,left:E,right:R}=r,o=s.scales.x,t=s.scales.y;if(!o||!t)return;const{xs:d,p95L:i,p95H:f,p80L:F,p80H:P}=x;if(!d.length)return;function _(k,j,H){e.save(),e.beginPath(),d.forEach((c,v)=>{const C=o.getPixelForValue(c),B=t.getPixelForValue(j[v]);v===0?e.moveTo(C,B):e.lineTo(C,B)});for(let c=d.length-1;c>=0;c--){const v=o.getPixelForValue(d[c]),C=t.getPixelForValue(k[c]);e.lineTo(v,C)}e.closePath(),e.fillStyle=H,e.fill(),e.restore()}_(i,f,M),_(F,P,W);const w=(T=s.getActiveElements)==null?void 0:T.call(s)[0];if(w){const k=s.scales.x.getPixelForValue(w.index);e.save(),e.strokeStyle="rgba(255,255,255,0.25)",e.lineWidth=1,e.beginPath(),e.moveTo(k,m),e.lineTo(k,y),e.stroke(),e.restore()}}};N.register(p);const a={animation:!1,responsive:!0,maintainAspectRatio:!1,scales:{x:{ticks:{color:L,autoSkip:!0,maxTicksLimit:8},grid:{color:D}},y:{ticks:{color:L},grid:{color:D}}},plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(17,17,17,0.95)",titleColor:"#fff",bodyColor:"#e5e7eb",borderColor:"rgba(255,255,255,0.12)",borderWidth:1,callbacks:{title:s=>{var r,e;return`Day ${((e=(r=s==null?void 0:s[0])==null?void 0:r.parsed)==null?void 0:e.x)??""}`},label:s=>{var r,e;return` ${s.dataset.label}: ${(e=(r=s.parsed.y)==null?void 0:r.toFixed)==null?void 0:e.call(r,2)}`}}}},elements:{line:{tension:.2}}},u=x.xs,l=new N(g,{type:"line",data:{labels:u,datasets:[{label:"Median",data:x.median,borderColor:V,backgroundColor:V,borderWidth:2,pointRadius:0}]},options:a});return b.current=l,()=>{l.destroy(),b.current=null,N.unregister(p)}},[n,x.xs.join(",")]),I.jsx("canvas",{ref:S,className:"w-full h-full"})}export{z as default};
