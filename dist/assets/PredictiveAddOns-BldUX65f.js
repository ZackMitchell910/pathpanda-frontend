import{j as n,R as D,d as g}from"./index-D1yz82GC.js";import{C as F,B as C,L as _}from"./index-Bl3GNjp6.js";const M=({pathsTerminal:e,ptiles:s})=>{if(!(e!=null&&e.length))return n.jsx("div",{className:"text-xs text-zinc-400",children:"No terminal data."});const t=[...e].sort((l,d)=>l-d),o=t.length,r=t[0],p=t[o-1],a=Math.min(60,Math.max(20,Math.floor(Math.sqrt(o)))),b=(p-r)/a||1,c=new Array(a).fill(0);for(const l of t){let d=Math.floor((l-r)/b);d>=a&&(d=a-1),d<0&&(d=0),c[d]+=1}const x=c.map(l=>l/(o*b)),i=[];let h=0;for(let l=0;l<a;l++)h+=c[l],i.push(h/o);const v={labels:Array.from({length:a},(l,d)=>(r+(d+.5)*b).toFixed(2)),datasets:[{type:"bar",label:"PDF",data:x,yAxisID:"y",borderWidth:0,backgroundColor:"rgba(99,102,241,0.45)",barPercentage:1,categoryPercentage:1},{type:"line",label:"CDF",data:i,yAxisID:"y1",borderColor:"#0EA5E9",borderWidth:2,pointRadius:0,tension:.15}]},A={responsive:!0,maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!0},tooltip:{enabled:!0}},scales:{x:{ticks:{maxRotation:0,autoSkip:!0},title:{display:!0,text:"Price"},grid:{display:!1}},y:{beginAtZero:!0,title:{display:!0,text:"PDF"},grid:{color:"rgba(148,163,184,0.15)"}},y1:{beginAtZero:!0,max:1,position:"right",title:{display:!0,text:"CDF"},grid:{display:!1}}}};return n.jsxs("div",{className:"relative w-full",style:{height:280},children:[n.jsx(F,{type:"bar",data:v,options:A}),n.jsxs("div",{className:"text-[11px] mt-2 grid grid-cols-3 gap-2 opacity-80",children:[(s==null?void 0:s.p05)!=null&&n.jsxs("div",{children:["p05: ",s.p05.toFixed(2)]}),(s==null?void 0:s.p50)!=null&&n.jsxs("div",{children:["p50: ",s.p50.toFixed(2)]}),(s==null?void 0:s.p95)!=null&&n.jsxs("div",{children:["p95: ",s.p95.toFixed(2)]})]})]})},E=({drivers:e})=>{const s=Array.isArray(e)?e:[];if(!s.length)return n.jsx("div",{className:"text-xs opacity-70",children:"No drivers yet."});const t=s.map(i=>String((i==null?void 0:i.name)??"")),o=s.map(i=>Number.isFinite(i==null?void 0:i.weight)?Number(i.weight):0),[r,p]=D.useState(null),a=async i=>`Explanation for ${i}: Influences price due to market trends.`,b=async i=>p(await a(i)),c={labels:t,datasets:[{label:"Driver Impact",data:o,backgroundColor:o.map(i=>i>=0?g.bull:g.bear),borderWidth:0}]},x={responsive:!0,indexAxis:"y",plugins:{legend:{display:!1},tooltip:{enabled:!0}},scales:{x:{title:{display:!0,text:"Impact"}},y:{title:{display:!0,text:"Drivers"}}},onClick:(i,h)=>{const u=(h==null?void 0:h[0])||void 0;(u==null?void 0:u.index)!=null&&b(t[u.index])}};return n.jsxs("div",{"data-chart":"drivers",children:[n.jsx(C,{data:c,options:x}),r&&n.jsx("div",{className:"text-sm mt-2",children:r})]})},k=({artifact:e,reps:s})=>{const t=Array.isArray(e==null?void 0:e.median_path)&&e.median_path.length?e.median_path.map(([a])=>`D${a}`):[],o=[];if(t.length&&Array.isArray(e==null?void 0:e.median_path)&&o.push({label:"Median",data:e.median_path.map(([,a])=>a),borderColor:g.median,borderWidth:2,pointRadius:0}),Array.isArray(s)&&s.length&&o.push(...s.map(a=>({label:a.label,data:(Array.isArray(a.path)?a.path:[]).map(([,b])=>b),borderColor:a.label.toLowerCase().includes("bull")?g.bull:g.bear,borderWidth:2,pointRadius:0}))),!t.length||!o.length)return n.jsx("div",{className:"text-xs opacity-70",children:"No scenarios computed."});const r={labels:t,datasets:o},p={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0},tooltip:{enabled:!0}}};return n.jsx("div",{"data-chart":"scenarios",children:n.jsx(_,{data:r,options:p})})};function W({probs:e}){const s=(e||[]).map(t=>({target:(t.target??t.label??"").toString(),prob:Number.isFinite(t.prob??t.p)?Number(t.prob??t.p):NaN})).filter(t=>t.target&&Number.isFinite(t.prob));return n.jsxs("div",{className:"rounded-lg border border-[#273141] bg-[#0E141C] p-3",children:[n.jsx("div",{className:"text-sm font-semibold mb-2",children:"Target Probabilities"}),n.jsxs("ul",{className:"space-y-1",children:[s.map((t,o)=>n.jsxs("li",{className:"flex items-center justify-between text-sm",children:[n.jsx("span",{className:"text-zinc-300",children:t.target}),n.jsxs("span",{className:"font-mono",children:[(t.prob*100).toFixed(1),"%"]})]},o)),s.length===0&&n.jsx("li",{className:"text-xs text-zinc-400",children:"No target probabilities."})]})]})}function B({artifact:e,thresholds:s=[-.05,0,.05,.1],S0:t,pathMatrixAbove:o}){var d,j,N;const r=(d=e==null?void 0:e.hit_probs)==null?void 0:d.probs_by_day,p=(j=e==null?void 0:e.hit_probs)==null?void 0:j.thresholds_abs,a=((N=r==null?void 0:r[0])==null?void 0:N.length)??(Number.isFinite(e==null?void 0:e.horizon_days)?e.horizon_days+1:0);if(!a)return n.jsx("div",{className:"text-xs opacity-70",children:"Run a simulation to see hit probabilities."});const b=Array.from({length:a},(m,y)=>`D${y}`),c=typeof t=="number"?t:Array.isArray(e==null?void 0:e.median_path)&&e.median_path.length?e.median_path[0][1]:void 0,x=p&&p.length&&typeof c=="number"?p.map(m=>m/c-1):s,i=o??((m,y)=>0),h=r&&r.length?r:typeof c=="number"?x.map(m=>Array.from({length:a},(y,f)=>i(f,(1+m)*c))):x.map(()=>Array.from({length:a},()=>0)),u=["#34D399","#22D3EE","#60A5FA","#FBBF24"],v=h.map((m,y)=>({label:`Above ${Math.round(x[y]*100)}%`,data:m,borderColor:u[y%u.length],borderWidth:2,pointRadius:0,tension:.15})),A={labels:b,datasets:v},l={responsive:!0,maintainAspectRatio:!1,scales:{x:{grid:{display:!1},ticks:{maxRotation:0},title:{display:!0,text:"Days"}},y:{min:0,max:1,title:{display:!0,text:"Probability"}}},plugins:{legend:{display:!0},tooltip:{enabled:!0}},elements:{line:{fill:!1}}};return n.jsx("div",{className:"relative w-full",style:{height:320},children:n.jsx(_,{data:A,options:l})})}export{E as DriversWaterfall,B as HitProbabilityRibbon,k as ScenarioTiles,W as TargetLadder,M as TerminalDistribution,B as default};
//# sourceMappingURL=PredictiveAddOns-BldUX65f.js.map
