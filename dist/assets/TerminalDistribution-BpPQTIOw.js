import{j as d,r as q,w as L}from"./index-D1yz82GC.js";import{C as R}from"./index-Bl3GNjp6.js";function p(i,e=2){return Number.isFinite(i)?i.toFixed(e):"â€”"}function B({pathsTerminal:i,ptiles:e,height:P=300}){if(!(i!=null&&i.length))return d.jsx("div",{className:"text-xs text-zinc-400",children:"No terminal data."});const m=q.useMemo(()=>{const n=(i&&i.length?i:prices)||[];if(!n.length)return d.jsx("div",{className:"text-xs text-zinc-400",children:"No terminal data."});const t=n.length,o=n[0],s=n[t-1],b=a=>{const r=(t-1)*a,j=Math.floor(r),C=Math.ceil(r),w=r-j;return n[j]*(1-w)+n[C]*w},F=b(.25),g=b(.75),x=2*Math.max(1e-9,g-F)/Math.cbrt(t),v=Math.max(1,Math.floor((s-o)/Math.max(x,1e-9))),c=Math.max(20,Math.min(80,v||20)),l=(s-o)/c||1,u=new Array(c).fill(0);for(const a of n){let r=Math.floor((a-o)/l);r>=c&&(r=c-1),r<0&&(r=0),u[r]+=1}const D=u.map(a=>a/(t*l)),M=[];let f=0;for(let a=0;a<c;a++)f+=u[a],M.push(f/t);const h=Array.from({length:c},(a,r)=>o+(r+.5)*l).map(a=>a.toFixed(2));return{n:t,vMin:o,vMax:s,nBins:c,binWidth:l,labels:h,pdf:D,cdf:M}},[i]),A={labels:m.labels,datasets:[{type:"bar",label:"PDF",data:m.pdf,yAxisID:"y",borderWidth:0,backgroundColor:n=>{var o,s;const t=(s=(o=n.chart)==null?void 0:o.options)==null?void 0:s.color;return t?`${t}55`:"rgba(148,163,184,0.45)"},barPercentage:1,categoryPercentage:1},{type:"line",label:"CDF",data:m.cdf,yAxisID:"y1",borderWidth:2,pointRadius:0,tension:.15}]},k=L({maintainAspectRatio:!1,interaction:{mode:"index",intersect:!1},plugins:{legend:{display:!1},tooltip:{callbacks:{title:n=>{var t;return`Price ~ ${((t=n[0])==null?void 0:t.label)??""}`},label:n=>n.dataset.type==="line"?`CDF: ${(Number(n.raw)*100).toFixed(1)}%`:`PDF: ${Number(n.raw).toFixed(4)}`}}},scales:{x:{ticks:{maxRotation:0,autoSkip:!0},title:{display:!0,text:"Price"},grid:{display:!1}},y:{beginAtZero:!0,title:{display:!0,text:"PDF"},grid:{display:!0}},y1:{beginAtZero:!0,max:1,position:"right",title:{display:!0,text:"CDF"},ticks:{callback:n=>`${(Number(n)*100).toFixed(0)}%`},grid:{display:!1}}}}),$={id:"percentileLines",afterDatasetsDraw:n=>{const t=n.ctx,o=n.scales.x,s=n.chartArea,{vMin:b,binWidth:F,nBins:g}=m,y=(x,v,c=!1)=>{if(!Number.isFinite(x))return;const l=(x-b)/F-.5,u=Math.max(0,Math.min(g-1,Math.floor(l))),D=Math.max(0,Math.min(g-1,Math.ceil(l))),M=Math.max(0,Math.min(1,l-Math.floor(l))),f=o.getPixelForValue(u),N=o.getPixelForValue(D),h=f+(N-f)*M;t.save(),t.beginPath(),t.setLineDash(c?[]:[4,4]),t.lineWidth=c?1.5:1,t.strokeStyle="rgba(255,255,255,0.35)",t.moveTo(h,s.top),t.lineTo(h,s.bottom),t.stroke(),t.setLineDash([]),t.font="10px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto",t.fillStyle="rgba(255,255,255,0.7)",t.textAlign="left",t.fillText(`${v} ${p(x)}`,h+4,s.top+10),t.restore()};(e==null?void 0:e.p05)!=null&&y(e.p05,"p05"),(e==null?void 0:e.p50)!=null&&y(e.p50,"p50",!0),(e==null?void 0:e.p95)!=null&&y(e.p95,"p95")}};return d.jsxs("div",{className:"relative w-full",style:{height:P},children:[d.jsx(R,{type:"bar",data:A,options:k,plugins:[$]}),d.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-[11px] opacity-80",children:[d.jsxs("div",{children:["p05: ",p(e==null?void 0:e.p05)]}),d.jsxs("div",{children:["p50: ",p(e==null?void 0:e.p50)]}),d.jsxs("div",{children:["p95: ",p(e==null?void 0:e.p95)]})]})]})}export{B as default};
//# sourceMappingURL=TerminalDistribution-BpPQTIOw.js.map
